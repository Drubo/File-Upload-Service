
/*!
 * nodeUpload
 * Copyright(c) 2012 Nibs Solution (BD) Ltd. <drubo@nibssolution.com>
 * MIT Licensed
 */

/**
 * Module dependencies.
 */
var httpServer = require('./server');

/**
 * Version.
 */
exports.version = '0.0.1';
 
exports.listen = function (host, port, options, fn) {
  if('number' == typeof host) port = host;
  if('object' == typeof host) options = host;
  if('function' == typeof host) fn = host;
  if('object' == typeof port) options = port;
  if('function' == typeof port) fn = port;
  if('function' == typeof options) fn = options;
  
  if('undefined' == typeof host || 'string' != typeof host){
	  //default host set to localhost
	  host = 'localhost';
  }
  
  if('undefined' == typeof port || 'number' != typeof port){
	  //default port set to 12345
	  port = 12345;
  }
  
  this.options = {
      origins: host+':'+port
    , pollingDuration: 20
    , flashPolicyServer: true
    , maxFileSize: 20990000 //20MB
    , chunkSize: 12288
  };
  
  
  if('object' == typeof options){
	  for (var i in options) {
		 this.options[i] = options[i];
	  }
  }
  
  var server = new httpServer(host, port, this.options, fn);
  return new exports.Manager(server, this.options);
};

exports.Manager = require('./manager');